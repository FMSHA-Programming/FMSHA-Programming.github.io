# Конспект 21 сентября 2021

## Массивы

Массив - это *структура данных* для работы с коллекцией элементов. Массив Си - это группа элементов *одного типа*, расположенных в памяти *последовательно*.

Определить массив целых можно так:

```c
int arr[12];
```

При этом выделяется память для хранения `12` элементов типа `int`. Значения элементов массива не инициализируются (т.е. могут быть любыми). Проинициализировать значения элементов можно с помощью цикла `for`:

```c
for (int i = 0; i < 12; ++i) {
    arr[i] = 0;
}
```

Этот пример показывает, что к элементам массива можно обращаться по индексу с помощью оператора квадратных скобок `[]`. Индекс первого элемента равен нулю. Индекс последнего элемента равен размеру массива минус один. Необходимо следить за тем, чтобы индексы находились внутри этого диапазона значений.

Массив можно инициализировать с помощью *списка инициализаторов*:

```c
int arr2[] = {1, 2, 3, 4};
```

Рамер массива при этом можно не указывать. Если указать размер массива больше, чем элементов в списке инициализаторов, то проинициализируются только соответствующие первые элементы.

**Пример 1. Гистограмма.**

На прошлом занятии вы писали самостоятельную работу. Заведем массив `scores` с вашими баллами:

```c
int scores[] = {5, 7, 6, 8, 9, 9, 6, 8, 6, 8, 7, 7, 7};
```

Заведем второй массив `hist`, с помощью которого посчитаем сколько раз было получено каждое значение баллов:

```c
int hist[11];
    
for (int i = 0; i < 11; ++i)
    hist[i] = 0;

for (int i = 0; i < 13; ++i)
    ++hist[scores[i]];
```

Наконец, выведем данные в консоль:

```c
for (int i = 0; i < 11; ++i) {
    printf("%2d: %2d  ", i, hist[i]);
    for (int j = 0; j < hist[i]; ++j)
        putchar('*');
    putchar('\n');
}
```

Вот результат:

```bash
 0:  0  
 1:  0  
 2:  0  
 3:  0  
 4:  0  
 5:  1  *
 6:  3  ***
 7:  4  ****
 8:  3  ***
 9:  2  **
10:  0
```

Функция `putchar` из библиотеки `stdio.h` позволяет выводить один символ в поток вывода (также существует функция `getchar`, которая получает из потока ввода один символ).

Звездочками (символ `*`) мы построили [*гистограмму*](https://ru.wikipedia.org/wiki/%D0%93%D0%B8%D1%81%D1%82%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B0).

## Строки

Строки в Си являются являются массивами элементов `char`:

```c
char s1[] = {'H', 'e', 'l', 'l', 'o', '\0'};
char s2[] = "Hello";
```

Объекты `s1` и `s2` представлены в памяти одинаково. Любой из них можно передать в функцию `printf` с параметром `%f`:

```c
printf("%s\n%s\n", s1, s2);
```

Каждая строка в Си заканчивается символом `\0`. Поэтому для строки `Hello` будет выделена память для хранения шести `char`:

```c
size_t s2len = sizeof(s2) / sizeof(char));
// s2len = 6
```

Если бы мы не добавили `\0` в конец массива `s1`, то функция `printf` не могла бы верно определить конец строки.

Считывание строки из консоли:

```c
printf("What is your name?\n");
char s3[15];
scanf("%s", s3);
printf("Hello, %s\n", s3);
```

Чтобы функция `scanf` не записала слишком много символов в строку, можно ограничить количество считываемых символов:

```c
scanf("%15s", s3);
```

Эта команда запишет не более `15` символов в переменную `s3`.

### Передача массива в функцию

Определим функцию, которая принимает массив целых чисел и возводит в квадрат каждый элемент массива:

```c
void array_square(int arr[], size_t size) {
    for (size_t i = 0; i < size; ++i) {
        arr[i] *= arr[i];
    }
}
```

Вместе с массивом необходимо передавать его размер.

Передача массива в функцию осуществляется по имени массива:

```c
int arr2[] = {1, 2, 3, 4};
array_square(arr2, 4);
for (int i = 0; i < 4; ++i)
    printf("%d%c", arr2[i], i < 3 ? ' ' : '\n');
```

```bash
1 4 9 16
```

Заметим, что при передачи массива в функцию не происходит копирования, поскольку имя массива - это по сути указатель на его первый элемент. Функция `array_square` могла бы быть объявлена и так:

```c
void array_square(int *arr, size_t size) {
    for (size_t i = 0; i < size; ++i) {
        arr[i] *= arr[i];
    }
}
```

Если функция не должна менять массив, то константность аргумента можно указать явно (это замечание касается аргументов любого типа):

```c
void print_square(const int arr[], size_t size) {
    for (size_t i = 0; i < size; ++i) {
        printf("%d%c", arr[i], i < 3 ? ' ' : '\n');
    }
}
```

### Задание размера массива во время исполнения программы

До сих пор мы задавали размер массива с помощью констант, *известных в момент компиляции*. Можно, однако, иметь массив, размер которого определяется только *во время исполнения программы*:

```c
int size;
scanf("%d", &size);
int arr[size];
```

Изменять размер уже существующего массива нельзя.

### Многомерные массивы

Си поддерживает многомерные массивы. Двумерный массив, например, можно определить так:

```c
int matrix[3][2] = {
    {1, 0},
    {0, 1},
    {1, 0}
};

for (int i = 0; i < 3; ++i) {
    for (int j = 0; j < 2; ++j) {
        printf("%3d", matrix[i][j]);
    }
    putchar('\n');
}
```

```bash
  1  0
  0  1
  1  0
```

## Указатели

Указатель - это переменная, значение которой является адресом в памяти.
